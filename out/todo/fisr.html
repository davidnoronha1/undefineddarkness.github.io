<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="icon" type="image/png" href="/favicon.png" />
		<meta name="author" content="nes" />
		<title>Fast Inverse Square Root (Quake III Arena)</title>
		<link rel="stylesheet" href="/assets/styles.css" />
	</head>
	<body>
	  <article>


		<!-- KATEX LOADING -->
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"></script>
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" onload="
			renderMathInElement(document.body, {
				output: 'mathml'
			});
		"></script>
		<header>
<h1>Fast Inverse Square Root (Quake III Arena)</h1>
</header>
<br/>
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/OpenArena-Rocket.jpg/1024px-OpenArena-Rocket.jpg" class="inline">
In 1999, The Source code for the game quake 3 arena was released, containing a rather ingenious algoritm for calculating the inverse square root of a number (\(\frac{1}{\sqrt{x}}\)), In a case, its required to calculate this very often for vector calculations and when quake 3 was being made, it was an expensive calculation that required approximation.

<pre>
<code class="language-c">float Q_rsqrt( float number )
{
	int32_t i;
	float x2, y;
	const float threehalfs = 1.5F;

	x2 = number * 0.5F;
	y  = number;
	i  = <i> ( int32_t </i> ) &y;                       // evil floating point bit level hacking
	i  = 0x5f3759df - ( i >> 1 );               // what the fuck? 
	y  = <i> ( float </i> ) &i;
	y  = y <i> ( threehalfs - ( x2 </i> y * y ) );   // 1st iteration
//	y  = y <i> ( threehalfs - ( x2 </i> y * y ) );   // 2nd iteration, this can be removed

	return y;
}	</code>
</pre>

To understand this bit of trickery, we need to know a few things,
<ul>
<li>Binary reprensentation of integers and floating point numbers
</li>
<li>Math behind it
</li>
<li>C trickery
</li>
</ul><br/><h2 id="binary-reprentation-of-numbers">Binary Reprentation of Numbers</h2>
<p>
</p>
<h3 id="integers">Integers</h3>
<p>
A <code>int32_t</code> as the name implies is 32 bits long
<img src="/assets/images/binary.svg" alt="" title="" loading="lazy" />


\[

\]
			<footer style="margin-bottom: 2em;">
				<a class="special" href="/out/index.html">Return To Index</a>
			</footer>
	  </article>
	</body>
</html>
