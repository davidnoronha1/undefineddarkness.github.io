<span style="color:#0057ae">void</span> <span style="color:#010181">BeginMode3D</span><span style="color:#000000">(</span>Camera camera<span style="color:#000000">){</span>
    <span style="color:#010181">rlDrawRenderBatchActive</span><span style="color:#000000">();</span>      <span style="color:#838183; font-style:italic">// Update and draw internal render batch</span>
    <span style="color:#010181">rlMatrixMode</span><span style="color:#000000">(</span>RL_PROJECTION<span style="color:#000000">);</span>    <span style="color:#838183; font-style:italic">// Switch to projection matrix</span>
    <span style="color:#010181">rlPushMatrix</span><span style="color:#000000">();</span>                 <span style="color:#838183; font-style:italic">// Save previous matrix, which contains the settings for the 2d ortho projection</span>
    <span style="color:#010181">rlLoadIdentity</span><span style="color:#000000">();</span>               <span style="color:#838183; font-style:italic">// Reset current matrix (projection)</span>
    <span style="color:#0057ae">float</span> aspect <span style="color:#000000">= (</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>CORE<span style="color:#000000">.</span>Window<span style="color:#000000">.</span>currentFbo<span style="color:#000000">.</span>width<span style="color:#000000">/(</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>CORE<span style="color:#000000">.</span>Window<span style="color:#000000">.</span>currentFbo<span style="color:#000000">.</span>height<span style="color:#000000">;</span>
    <span style="color:#838183; font-style:italic">// NOTE: zNear and zFar values are important when computing depth buffer values</span>
    <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>camera<span style="color:#000000">.</span>projection <span style="color:#000000">==</span> CAMERA_PERSPECTIVE<span style="color:#000000">)</span>
    <span style="color:#000000">{</span>
        <span style="color:#838183; font-style:italic">// Setup perspective projection</span>
        <span style="color:#0057ae">double</span> top <span style="color:#000000">=</span> RL_CULL_DISTANCE_NEAR<span style="color:#000000">*</span><span style="color:#010181">tan</span><span style="color:#000000">(</span>camera<span style="color:#000000">.</span>fovy<span style="color:#000000">*</span><span style="color:#b07e00">0.5</span><span style="color:#000000">*</span>DEG2RAD<span style="color:#000000">);</span>
        <span style="color:#0057ae">double</span> right <span style="color:#000000">=</span> top<span style="color:#000000">*</span>aspect<span style="color:#000000">;</span>
        <span style="color:#010181">rlFrustum</span><span style="color:#000000">(-</span>right<span style="color:#000000">,</span> right<span style="color:#000000">, -</span>top<span style="color:#000000">,</span> top<span style="color:#000000">,</span> RL_CULL_DISTANCE_NEAR<span style="color:#000000">,</span> RL_CULL_DISTANCE_FAR<span style="color:#000000">);</span>
    <span style="color:#000000">}</span>
    <span style="color:#000000; font-weight:bold">else if</span> <span style="color:#000000">(</span>camera<span style="color:#000000">.</span>projection <span style="color:#000000">==</span> CAMERA_ORTHOGRAPHIC<span style="color:#000000">)</span>
    <span style="color:#000000">{</span>
        <span style="color:#838183; font-style:italic">// Setup orthographic projection</span>
        <span style="color:#0057ae">double</span> top <span style="color:#000000">=</span> camera<span style="color:#000000">.</span>fovy<span style="color:#000000">/</span><span style="color:#b07e00">2.0</span><span style="color:#000000">;</span>
        <span style="color:#0057ae">double</span> right <span style="color:#000000">=</span> top<span style="color:#000000">*</span>aspect<span style="color:#000000">;</span>
        <span style="color:#010181">rlOrtho</span><span style="color:#000000">(-</span>right<span style="color:#000000">,</span> right<span style="color:#000000">, -</span>top<span style="color:#000000">,</span>top<span style="color:#000000">,</span> RL_CULL_DISTANCE_NEAR<span style="color:#000000">,</span> RL_CULL_DISTANCE_FAR<span style="color:#000000">);</span>
    <span style="color:#000000">}</span>
    <span style="color:#010181">rlMatrixMode</span><span style="color:#000000">(</span>RL_MODELVIEW<span style="color:#000000">);</span>     <span style="color:#838183; font-style:italic">// Switch back to modelview matrix</span>
    <span style="color:#010181">rlLoadIdentity</span><span style="color:#000000">();</span>               <span style="color:#838183; font-style:italic">// Reset current matrix (modelview)</span>
    <span style="color:#838183; font-style:italic">// Setup Camera view</span>
    Matrix matView <span style="color:#000000">=</span> <span style="color:#010181">MatrixLookAt</span><span style="color:#000000">(</span>camera<span style="color:#000000">.</span>position<span style="color:#000000">,</span> camera<span style="color:#000000">.</span>target<span style="color:#000000">,</span> camera<span style="color:#000000">.</span>up<span style="color:#000000">);</span>
    <span style="color:#010181">rlMultMatrixf</span><span style="color:#000000">(</span><span style="color:#010181">MatrixToFloat</span><span style="color:#000000">(</span>matView<span style="color:#000000">));</span>      <span style="color:#838183; font-style:italic">// Multiply modelview matrix by view matrix (camera)</span>
    <span style="color:#010181">rlEnableDepthTest</span><span style="color:#000000">();</span>            <span style="color:#838183; font-style:italic">// Enable DEPTH_TEST for 3D</span>
<span style="color:#000000">}</span>
