Image <span style="color:#010181">GenImageFontAtlas</span><span style="color:#000000">(</span><span style="color:#0057ae">const</span> GlyphInfo <span style="color:#000000">*</span>chars<span style="color:#000000">,</span> Rectangle <span style="color:#000000">**</span>charRecs<span style="color:#000000">,</span> <span style="color:#0057ae">int</span> glyphCount<span style="color:#000000">,</span> <span style="color:#0057ae">int</span> fontSize<span style="color:#000000">,</span> <span style="color:#0057ae">int</span> padding<span style="color:#000000">,</span> <span style="color:#0057ae">int</span> packMethod<span style="color:#000000">){</span>
    Image atlas <span style="color:#000000">= {</span> <span style="color:#b07e00">0</span> <span style="color:#000000">};</span>
    <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>chars <span style="color:#000000">==</span> NULL<span style="color:#000000">)</span>
    <span style="color:#000000">{</span>
        <span style="color:#010181">TRACELOG</span><span style="color:#000000">(</span>LOG_WARNING<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;FONT: Provided chars info not valid, returning empty image atlas&quot;</span><span style="color:#000000">);</span>
        <span style="color:#000000; font-weight:bold">return</span> atlas<span style="color:#000000">;</span>
    <span style="color:#000000">}</span>
    <span style="color:#000000">*</span>charRecs <span style="color:#000000">=</span> NULL<span style="color:#000000">;</span>
    <span style="color:#838183; font-style:italic">// In case no chars count provided we suppose default of 95</span>
    glyphCount <span style="color:#000000">= (</span>glyphCount <span style="color:#000000">&gt;</span> <span style="color:#b07e00">0</span><span style="color:#000000">)?</span> glyphCount <span style="color:#000000">:</span> <span style="color:#b07e00">95</span><span style="color:#000000">;</span>
    <span style="color:#838183; font-style:italic">// NOTE: Rectangles memory is loaded here!</span>
    Rectangle <span style="color:#000000">*</span>recs <span style="color:#000000">= (</span>Rectangle <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>glyphCount<span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span>Rectangle<span style="color:#000000">));</span>
    <span style="color:#838183; font-style:italic">// Calculate image size based on total glyph width and glyph row count</span>
    <span style="color:#0057ae">int</span> totalWidth <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
    <span style="color:#0057ae">int</span> maxGlyphWidth <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> i <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> i <span style="color:#000000">&lt;</span> glyphCount<span style="color:#000000">;</span> i<span style="color:#000000">++)</span>
    <span style="color:#000000">{</span>
        <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>width <span style="color:#000000">&gt;</span> maxGlyphWidth<span style="color:#000000">)</span> maxGlyphWidth <span style="color:#000000">=</span> chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>width<span style="color:#000000">;</span>
        totalWidth <span style="color:#000000">+=</span> chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>width <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">*</span>padding<span style="color:#000000">;</span>
    <span style="color:#000000">}</span>
    <span style="color:#0057ae">int</span> rowCount <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
    <span style="color:#0057ae">int</span> imageSize <span style="color:#000000">=</span> <span style="color:#b07e00">64</span><span style="color:#000000">;</span>  <span style="color:#838183; font-style:italic">// Define minimum starting value to avoid unnecessary calculation steps for very small images</span>
    <span style="color:#838183; font-style:italic">// NOTE: maxGlyphWidth is maximum possible space left at the end of row</span>
    <span style="color:#000000; font-weight:bold">while</span> <span style="color:#000000">(</span>totalWidth <span style="color:#000000">&gt; (</span>imageSize <span style="color:#000000">-</span> maxGlyphWidth<span style="color:#000000">)*</span>rowCount<span style="color:#000000">)</span>
    <span style="color:#000000">{</span>
        imageSize <span style="color:#000000">*=</span> <span style="color:#b07e00">2</span><span style="color:#000000">;</span>                                 <span style="color:#838183; font-style:italic">// Double the size of image (to keep POT)</span>
        rowCount <span style="color:#000000">=</span> imageSize<span style="color:#000000">/(</span>fontSize <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">*</span>padding<span style="color:#000000">);</span>    <span style="color:#838183; font-style:italic">// Calculate new row count for the new image size</span>
    <span style="color:#000000">}</span>
    atlas<span style="color:#000000">.</span>width <span style="color:#000000">=</span> imageSize<span style="color:#000000">;</span>   <span style="color:#838183; font-style:italic">// Atlas bitmap width</span>
    atlas<span style="color:#000000">.</span>height <span style="color:#000000">=</span> imageSize<span style="color:#000000">;</span>  <span style="color:#838183; font-style:italic">// Atlas bitmap height</span>
    atlas<span style="color:#000000">.</span>data <span style="color:#000000">= (</span><span style="color:#0057ae">unsigned char</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_CALLOC</span><span style="color:#000000">(</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span> atlas<span style="color:#000000">.</span>width<span style="color:#000000">*</span>atlas<span style="color:#000000">.</span>height<span style="color:#000000">);</span>   <span style="color:#838183; font-style:italic">// Create a bitmap to store characters (8 bpp)</span>
    atlas<span style="color:#000000">.</span>format <span style="color:#000000">=</span> PIXELFORMAT_UNCOMPRESSED_GRAYSCALE<span style="color:#000000">;</span>
    atlas<span style="color:#000000">.</span>mipmaps <span style="color:#000000">=</span> <span style="color:#b07e00">1</span><span style="color:#000000">;</span>
    <span style="color:#838183; font-style:italic">// DEBUG: We can see padding in the generated image setting a gray background...</span>
    <span style="color:#838183; font-style:italic">//for (int i = 0; i &lt; atlas.width*atlas.height; i++) ((unsigned char *)atlas.data)[i] = 100;</span>
    <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>packMethod <span style="color:#000000">==</span> <span style="color:#b07e00">0</span><span style="color:#000000">)</span>   <span style="color:#838183; font-style:italic">// Use basic packing algorithm</span>
    <span style="color:#000000">{</span>
        <span style="color:#0057ae">int</span> offsetX <span style="color:#000000">=</span> padding<span style="color:#000000">;</span>
        <span style="color:#0057ae">int</span> offsetY <span style="color:#000000">=</span> padding<span style="color:#000000">;</span>
        <span style="color:#838183; font-style:italic">// NOTE: Using simple packaging, one char after another</span>
        <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> i <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> i <span style="color:#000000">&lt;</span> glyphCount<span style="color:#000000">;</span> i<span style="color:#000000">++)</span>
        <span style="color:#000000">{</span>
            <span style="color:#838183; font-style:italic">// Check remaining space for glyph</span>
            <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>offsetX <span style="color:#000000">&gt;= (</span>atlas<span style="color:#000000">.</span>width <span style="color:#000000">-</span> chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>width <span style="color:#000000">-</span> <span style="color:#b07e00">2</span><span style="color:#000000">*</span>padding<span style="color:#000000">))</span>
            <span style="color:#000000">{</span>
                offsetX <span style="color:#000000">=</span> padding<span style="color:#000000">;</span>
                <span style="color:#838183; font-style:italic">// NOTE: Be careful on offsetY for SDF fonts, by default SDF</span>
                <span style="color:#838183; font-style:italic">// use an internal padding of 4 pixels, it means char rectangle</span>
                <span style="color:#838183; font-style:italic">// height is bigger than fontSize, it could be up to (fontSize + 8)</span>
                offsetY <span style="color:#000000">+= (</span>fontSize <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">*</span>padding<span style="color:#000000">);</span>
                <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>offsetY <span style="color:#000000">&gt; (</span>atlas<span style="color:#000000">.</span>height <span style="color:#000000">-</span> fontSize <span style="color:#000000">-</span> padding<span style="color:#000000">))</span>
                <span style="color:#000000">{</span>
                    <span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span> j <span style="color:#000000">=</span> i <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">;</span> j <span style="color:#000000">&lt;</span> glyphCount<span style="color:#000000">;</span> j<span style="color:#000000">++)</span>
                    <span style="color:#000000">{</span>
                        <span style="color:#010181">TRACELOG</span><span style="color:#000000">(</span>LOG_WARNING<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;FONT: Failed to package character (%i)&quot;</span><span style="color:#000000">,</span> j<span style="color:#000000">);</span>
                        <span style="color:#838183; font-style:italic">// make sure remaining recs contain valid data</span>
                        recs<span style="color:#000000">[</span>j<span style="color:#000000">].</span>x <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
                        recs<span style="color:#000000">[</span>j<span style="color:#000000">].</span>y <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
                        recs<span style="color:#000000">[</span>j<span style="color:#000000">].</span>width <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
                        recs<span style="color:#000000">[</span>j<span style="color:#000000">].</span>height <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
                    <span style="color:#000000">}</span>
                    <span style="color:#000000; font-weight:bold">break</span><span style="color:#000000">;</span>
                <span style="color:#000000">}</span>
            <span style="color:#000000">}</span>
            <span style="color:#838183; font-style:italic">// Copy pixel data from fc.data to atlas</span>
            <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> y <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> y <span style="color:#000000">&lt;</span> chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>height<span style="color:#000000">;</span> y<span style="color:#000000">++)</span>
            <span style="color:#000000">{</span>
                <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> x <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> x <span style="color:#000000">&lt;</span> chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>width<span style="color:#000000">;</span> x<span style="color:#000000">++)</span>
                <span style="color:#000000">{</span>
                    <span style="color:#000000">((</span><span style="color:#0057ae">unsigned char</span> <span style="color:#000000">*)</span>atlas<span style="color:#000000">.</span>data<span style="color:#000000">)[(</span>offsetY <span style="color:#000000">+</span> y<span style="color:#000000">)*</span>atlas<span style="color:#000000">.</span>width <span style="color:#000000">+ (</span>offsetX <span style="color:#000000">+</span> x<span style="color:#000000">)] = ((</span><span style="color:#0057ae">unsigned char</span> <span style="color:#000000">*)</span>chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>data<span style="color:#000000">)[</span>y<span style="color:#000000">*</span>chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>width <span style="color:#000000">+</span> x<span style="color:#000000">];</span>
                <span style="color:#000000">}</span>
            <span style="color:#000000">}</span>
            <span style="color:#838183; font-style:italic">// Fill chars rectangles in atlas info</span>
            recs<span style="color:#000000">[</span>i<span style="color:#000000">].</span>x <span style="color:#000000">= (</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>offsetX<span style="color:#000000">;</span>
            recs<span style="color:#000000">[</span>i<span style="color:#000000">].</span>y <span style="color:#000000">= (</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>offsetY<span style="color:#000000">;</span>
            recs<span style="color:#000000">[</span>i<span style="color:#000000">].</span>width <span style="color:#000000">= (</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>width<span style="color:#000000">;</span>
            recs<span style="color:#000000">[</span>i<span style="color:#000000">].</span>height <span style="color:#000000">= (</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>height<span style="color:#000000">;</span>
            <span style="color:#838183; font-style:italic">// Move atlas position X for next character drawing</span>
            offsetX <span style="color:#000000">+= (</span>chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>width <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">*</span>padding<span style="color:#000000">);</span>
        <span style="color:#000000">}</span>
    <span style="color:#000000">}</span>
    <span style="color:#000000; font-weight:bold">else if</span> <span style="color:#000000">(</span>packMethod <span style="color:#000000">==</span> <span style="color:#b07e00">1</span><span style="color:#000000">)</span>  <span style="color:#838183; font-style:italic">// Use Skyline rect packing algorithm (stb_pack_rect)</span>
    <span style="color:#000000">{</span>
        stbrp_context <span style="color:#000000">*</span>context <span style="color:#000000">= (</span>stbrp_context <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(*</span>context<span style="color:#000000">));</span>
        stbrp_node <span style="color:#000000">*</span>nodes <span style="color:#000000">= (</span>stbrp_node <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>glyphCount<span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(*</span>nodes<span style="color:#000000">));</span>
        <span style="color:#010181">stbrp_init_target</span><span style="color:#000000">(</span>context<span style="color:#000000">,</span> atlas<span style="color:#000000">.</span>width<span style="color:#000000">,</span> atlas<span style="color:#000000">.</span>height<span style="color:#000000">,</span> nodes<span style="color:#000000">,</span> glyphCount<span style="color:#000000">);</span>
        stbrp_rect <span style="color:#000000">*</span>rects <span style="color:#000000">= (</span>stbrp_rect <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>glyphCount<span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span>stbrp_rect<span style="color:#000000">));</span>
        <span style="color:#838183; font-style:italic">// Fill rectangles for packaging</span>
        <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> i <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> i <span style="color:#000000">&lt;</span> glyphCount<span style="color:#000000">;</span> i<span style="color:#000000">++)</span>
        <span style="color:#000000">{</span>
            rects<span style="color:#000000">[</span>i<span style="color:#000000">].</span>id <span style="color:#000000">=</span> i<span style="color:#000000">;</span>
            rects<span style="color:#000000">[</span>i<span style="color:#000000">].</span>w <span style="color:#000000">=</span> chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>width <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">*</span>padding<span style="color:#000000">;</span>
            rects<span style="color:#000000">[</span>i<span style="color:#000000">].</span>h <span style="color:#000000">=</span> chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>height <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">*</span>padding<span style="color:#000000">;</span>
        <span style="color:#000000">}</span>
        <span style="color:#838183; font-style:italic">// Package rectangles into atlas</span>
        <span style="color:#010181">stbrp_pack_rects</span><span style="color:#000000">(</span>context<span style="color:#000000">,</span> rects<span style="color:#000000">,</span> glyphCount<span style="color:#000000">);</span>
        <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> i <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> i <span style="color:#000000">&lt;</span> glyphCount<span style="color:#000000">;</span> i<span style="color:#000000">++)</span>
        <span style="color:#000000">{</span>
            <span style="color:#838183; font-style:italic">// It returns char rectangles in atlas</span>
            recs<span style="color:#000000">[</span>i<span style="color:#000000">].</span>x <span style="color:#000000">=</span> rects<span style="color:#000000">[</span>i<span style="color:#000000">].</span>x <span style="color:#000000">+ (</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>padding<span style="color:#000000">;</span>
            recs<span style="color:#000000">[</span>i<span style="color:#000000">].</span>y <span style="color:#000000">=</span> rects<span style="color:#000000">[</span>i<span style="color:#000000">].</span>y <span style="color:#000000">+ (</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>padding<span style="color:#000000">;</span>
            recs<span style="color:#000000">[</span>i<span style="color:#000000">].</span>width <span style="color:#000000">= (</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>width<span style="color:#000000">;</span>
            recs<span style="color:#000000">[</span>i<span style="color:#000000">].</span>height <span style="color:#000000">= (</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>height<span style="color:#000000">;</span>
            <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>rects<span style="color:#000000">[</span>i<span style="color:#000000">].</span>was_packed<span style="color:#000000">)</span>
            <span style="color:#000000">{</span>
                <span style="color:#838183; font-style:italic">// Copy pixel data from fc.data to atlas</span>
                <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> y <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> y <span style="color:#000000">&lt;</span> chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>height<span style="color:#000000">;</span> y<span style="color:#000000">++)</span>
                <span style="color:#000000">{</span>
                    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> x <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> x <span style="color:#000000">&lt;</span> chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>width<span style="color:#000000">;</span> x<span style="color:#000000">++)</span>
                    <span style="color:#000000">{</span>
                        <span style="color:#000000">((</span><span style="color:#0057ae">unsigned char</span> <span style="color:#000000">*)</span>atlas<span style="color:#000000">.</span>data<span style="color:#000000">)[(</span>rects<span style="color:#000000">[</span>i<span style="color:#000000">].</span>y <span style="color:#000000">+</span> padding <span style="color:#000000">+</span> y<span style="color:#000000">)*</span>atlas<span style="color:#000000">.</span>width <span style="color:#000000">+ (</span>rects<span style="color:#000000">[</span>i<span style="color:#000000">].</span>x <span style="color:#000000">+</span> padding <span style="color:#000000">+</span> x<span style="color:#000000">)] = ((</span><span style="color:#0057ae">unsigned char</span> <span style="color:#000000">*)</span>chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>data<span style="color:#000000">)[</span>y<span style="color:#000000">*</span>chars<span style="color:#000000">[</span>i<span style="color:#000000">].</span>image<span style="color:#000000">.</span>width <span style="color:#000000">+</span> x<span style="color:#000000">];</span>
                    <span style="color:#000000">}</span>
                <span style="color:#000000">}</span>
            <span style="color:#000000">}</span>
            <span style="color:#000000; font-weight:bold">else</span> <span style="color:#010181">TRACELOG</span><span style="color:#000000">(</span>LOG_WARNING<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;FONT: Failed to package character (%i)&quot;</span><span style="color:#000000">,</span> i<span style="color:#000000">);</span>
        <span style="color:#000000">}</span>
        <span style="color:#010181">RL_FREE</span><span style="color:#000000">(</span>rects<span style="color:#000000">);</span>
        <span style="color:#010181">RL_FREE</span><span style="color:#000000">(</span>nodes<span style="color:#000000">);</span>
        <span style="color:#010181">RL_FREE</span><span style="color:#000000">(</span>context<span style="color:#000000">);</span>
    <span style="color:#000000">}</span>
    <span style="color:#838183; font-style:italic">// Convert image data from GRAYSCALE to GRAY_ALPHA</span>
    <span style="color:#0057ae">unsigned char</span> <span style="color:#000000">*</span>dataGrayAlpha <span style="color:#000000">= (</span><span style="color:#0057ae">unsigned char</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>atlas<span style="color:#000000">.</span>width<span style="color:#000000">*</span>atlas<span style="color:#000000">.</span>height<span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">unsigned char</span><span style="color:#000000">)*</span><span style="color:#b07e00">2</span><span style="color:#000000">);</span> <span style="color:#838183; font-style:italic">// Two channels</span>
    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> i <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">,</span> k <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> i <span style="color:#000000">&lt;</span> atlas<span style="color:#000000">.</span>width<span style="color:#000000">*</span>atlas<span style="color:#000000">.</span>height<span style="color:#000000">;</span> i<span style="color:#000000">++,</span> k <span style="color:#000000">+=</span> <span style="color:#b07e00">2</span><span style="color:#000000">)</span>
    <span style="color:#000000">{</span>
        dataGrayAlpha<span style="color:#000000">[</span>k<span style="color:#000000">] =</span> <span style="color:#b07e00">255</span><span style="color:#000000">;</span>
        dataGrayAlpha<span style="color:#000000">[</span>k <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">] = ((</span><span style="color:#0057ae">unsigned char</span> <span style="color:#000000">*)</span>atlas<span style="color:#000000">.</span>data<span style="color:#000000">)[</span>i<span style="color:#000000">];</span>
    <span style="color:#000000">}</span>
    <span style="color:#010181">RL_FREE</span><span style="color:#000000">(</span>atlas<span style="color:#000000">.</span>data<span style="color:#000000">);</span>
    atlas<span style="color:#000000">.</span>data <span style="color:#000000">=</span> dataGrayAlpha<span style="color:#000000">;</span>
    atlas<span style="color:#000000">.</span>format <span style="color:#000000">=</span> PIXELFORMAT_UNCOMPRESSED_GRAY_ALPHA<span style="color:#000000">;</span>
    <span style="color:#000000">*</span>charRecs <span style="color:#000000">=</span> recs<span style="color:#000000">;</span>
    <span style="color:#000000; font-weight:bold">return</span> atlas<span style="color:#000000">;</span>
<span style="color:#000000">}</span>
<span style="color:#008200">#endif</span>
