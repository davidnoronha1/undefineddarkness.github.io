Mesh <span style="color:#010181">GenMeshCone</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span> radius<span style="color:#000000">,</span> <span style="color:#0057ae">float</span> height<span style="color:#000000">,</span> <span style="color:#0057ae">int</span> slices<span style="color:#000000">){</span>
    Mesh mesh <span style="color:#000000">= {</span> <span style="color:#b07e00">0</span> <span style="color:#000000">};</span>
    <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>slices <span style="color:#000000">&gt;=</span> <span style="color:#b07e00">3</span><span style="color:#000000">)</span>
    <span style="color:#000000">{</span>
        <span style="color:#838183; font-style:italic">// Instance a cone that sits on the Z=0 plane using the given tessellation</span>
        <span style="color:#838183; font-style:italic">// levels across the UV domain.  Think of &quot;slices&quot; like a number of pizza</span>
        <span style="color:#838183; font-style:italic">// slices, and &quot;stacks&quot; like a number of stacked rings.</span>
        <span style="color:#838183; font-style:italic">// Height and radius are both 1.0, but they can easily be changed with par_shapes_scale</span>
        par_shapes_mesh <span style="color:#000000">*</span>cone <span style="color:#000000">=</span> <span style="color:#010181">par_shapes_create_cone</span><span style="color:#000000">(</span>slices<span style="color:#000000">,</span> <span style="color:#b07e00">8</span><span style="color:#000000">);</span>
        <span style="color:#010181">par_shapes_scale</span><span style="color:#000000">(</span>cone<span style="color:#000000">,</span> radius<span style="color:#000000">,</span> radius<span style="color:#000000">,</span> height<span style="color:#000000">);</span>
        <span style="color:#010181">par_shapes_rotate</span><span style="color:#000000">(</span>cone<span style="color:#000000">, -</span>PI<span style="color:#000000">/</span><span style="color:#b07e00">2.0</span>f<span style="color:#000000">, (</span><span style="color:#0057ae">float</span><span style="color:#000000">[]){</span> <span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span> <span style="color:#000000">});</span>
        <span style="color:#010181">par_shapes_rotate</span><span style="color:#000000">(</span>cone<span style="color:#000000">,</span> PI<span style="color:#000000">/</span><span style="color:#b07e00">2.0</span>f<span style="color:#000000">, (</span><span style="color:#0057ae">float</span><span style="color:#000000">[]){</span> <span style="color:#b07e00">0</span><span style="color:#000000">,</span> <span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span> <span style="color:#000000">});</span>
        <span style="color:#838183; font-style:italic">// Generate an orientable disk shape (bottom cap)</span>
        par_shapes_mesh <span style="color:#000000">*</span>capBottom <span style="color:#000000">=</span> <span style="color:#010181">par_shapes_create_disk</span><span style="color:#000000">(</span>radius<span style="color:#000000">,</span> slices<span style="color:#000000">, (</span><span style="color:#0057ae">float</span><span style="color:#000000">[]){</span> <span style="color:#b07e00">0</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span> <span style="color:#000000">}, (</span><span style="color:#0057ae">float</span><span style="color:#000000">[]){</span> <span style="color:#b07e00">0</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span><span style="color:#000000">, -</span><span style="color:#b07e00">1</span> <span style="color:#000000">});</span>
        capBottom<span style="color:#000000">-&gt;</span>tcoords <span style="color:#000000">=</span> <span style="color:#010181">PAR_MALLOC</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span><span style="color:#000000">,</span> <span style="color:#b07e00">2</span><span style="color:#000000">*</span>capBottom<span style="color:#000000">-&gt;</span>npoints<span style="color:#000000">);</span>
        <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> i <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> i <span style="color:#000000">&lt;</span> <span style="color:#b07e00">2</span><span style="color:#000000">*</span>capBottom<span style="color:#000000">-&gt;</span>npoints<span style="color:#000000">;</span> i<span style="color:#000000">++)</span> capBottom<span style="color:#000000">-&gt;</span>tcoords<span style="color:#000000">[</span>i<span style="color:#000000">] =</span> <span style="color:#b07e00">0.95</span>f<span style="color:#000000">;</span>
        <span style="color:#010181">par_shapes_rotate</span><span style="color:#000000">(</span>capBottom<span style="color:#000000">,</span> PI<span style="color:#000000">/</span><span style="color:#b07e00">2.0</span>f<span style="color:#000000">, (</span><span style="color:#0057ae">float</span><span style="color:#000000">[]){</span> <span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span> <span style="color:#000000">});</span>
        <span style="color:#010181">par_shapes_merge_and_free</span><span style="color:#000000">(</span>cone<span style="color:#000000">,</span> capBottom<span style="color:#000000">);</span>
        mesh<span style="color:#000000">.</span>vertices <span style="color:#000000">= (</span><span style="color:#0057ae">float</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>cone<span style="color:#000000">-&gt;</span>ntriangles<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span><span style="color:#000000">));</span>
        mesh<span style="color:#000000">.</span>texcoords <span style="color:#000000">= (</span><span style="color:#0057ae">float</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>cone<span style="color:#000000">-&gt;</span>ntriangles<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#b07e00">2</span><span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span><span style="color:#000000">));</span>
        mesh<span style="color:#000000">.</span>normals <span style="color:#000000">= (</span><span style="color:#0057ae">float</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>cone<span style="color:#000000">-&gt;</span>ntriangles<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span><span style="color:#000000">));</span>
        mesh<span style="color:#000000">.</span>vertexCount <span style="color:#000000">=</span> cone<span style="color:#000000">-&gt;</span>ntriangles<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">;</span>
        mesh<span style="color:#000000">.</span>triangleCount <span style="color:#000000">=</span> cone<span style="color:#000000">-&gt;</span>ntriangles<span style="color:#000000">;</span>
        <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> k <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> k <span style="color:#000000">&lt;</span> mesh<span style="color:#000000">.</span>vertexCount<span style="color:#000000">;</span> k<span style="color:#000000">++)</span>
        <span style="color:#000000">{</span>
            mesh<span style="color:#000000">.</span>vertices<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">] =</span> cone<span style="color:#000000">-&gt;</span>points<span style="color:#000000">[</span>cone<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">3</span><span style="color:#000000">];</span>
            mesh<span style="color:#000000">.</span>vertices<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">] =</span> cone<span style="color:#000000">-&gt;</span>points<span style="color:#000000">[</span>cone<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">];</span>
            mesh<span style="color:#000000">.</span>vertices<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">] =</span> cone<span style="color:#000000">-&gt;</span>points<span style="color:#000000">[</span>cone<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">];</span>
            mesh<span style="color:#000000">.</span>normals<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">] =</span> cone<span style="color:#000000">-&gt;</span>normals<span style="color:#000000">[</span>cone<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">3</span><span style="color:#000000">];</span>
            mesh<span style="color:#000000">.</span>normals<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">] =</span> cone<span style="color:#000000">-&gt;</span>normals<span style="color:#000000">[</span>cone<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">];</span>
            mesh<span style="color:#000000">.</span>normals<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">] =</span> cone<span style="color:#000000">-&gt;</span>normals<span style="color:#000000">[</span>cone<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">];</span>
            mesh<span style="color:#000000">.</span>texcoords<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">2</span><span style="color:#000000">] =</span> cone<span style="color:#000000">-&gt;</span>tcoords<span style="color:#000000">[</span>cone<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">2</span><span style="color:#000000">];</span>
            mesh<span style="color:#000000">.</span>texcoords<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">2</span> <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">] =</span> cone<span style="color:#000000">-&gt;</span>tcoords<span style="color:#000000">[</span>cone<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">2</span> <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">];</span>
        <span style="color:#000000">}</span>
        <span style="color:#010181">par_shapes_free_mesh</span><span style="color:#000000">(</span>cone<span style="color:#000000">);</span>
        <span style="color:#838183; font-style:italic">// Upload vertex data to GPU (static mesh)</span>
        <span style="color:#010181">UploadMesh</span><span style="color:#000000">(&amp;</span>mesh<span style="color:#000000">,</span> <span style="color:#000000; font-weight:bold">false</span><span style="color:#000000">);</span>
    <span style="color:#000000">}</span>
    <span style="color:#000000; font-weight:bold">else</span> <span style="color:#010181">TRACELOG</span><span style="color:#000000">(</span>LOG_WARNING<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;MESH: Failed to generate mesh: cone&quot;</span><span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">return</span> mesh<span style="color:#000000">;</span>
<span style="color:#000000">}</span>
