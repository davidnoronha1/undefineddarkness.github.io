Color <span style="color:#010181">ColorFromHSV</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span> hue<span style="color:#000000">,</span> <span style="color:#0057ae">float</span> saturation<span style="color:#000000">,</span> <span style="color:#0057ae">float</span> value<span style="color:#000000">){</span>
    Color color <span style="color:#000000">= {</span> <span style="color:#b07e00">0</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span><span style="color:#000000">,</span> <span style="color:#b07e00">255</span> <span style="color:#000000">};</span>
    <span style="color:#838183; font-style:italic">// Red channel</span>
    <span style="color:#0057ae">float</span> k <span style="color:#000000">=</span> <span style="color:#010181">fmodf</span><span style="color:#000000">((</span><span style="color:#b07e00">5.0</span>f <span style="color:#000000">+</span> hue<span style="color:#000000">/</span><span style="color:#b07e00">60.0</span>f<span style="color:#000000">),</span> <span style="color:#b07e00">6</span><span style="color:#000000">);</span>
    <span style="color:#0057ae">float</span> t <span style="color:#000000">=</span> <span style="color:#b07e00">4.0</span>f <span style="color:#000000">-</span> k<span style="color:#000000">;</span>
    k <span style="color:#000000">= (</span>t <span style="color:#000000">&lt;</span> k<span style="color:#000000">)?</span> t <span style="color:#000000">:</span> k<span style="color:#000000">;</span>
    k <span style="color:#000000">= (</span>k <span style="color:#000000">&lt;</span> <span style="color:#b07e00">1</span><span style="color:#000000">)?</span> k <span style="color:#000000">:</span> <span style="color:#b07e00">1</span><span style="color:#000000">;</span>
    k <span style="color:#000000">= (</span>k <span style="color:#000000">&gt;</span> <span style="color:#b07e00">0</span><span style="color:#000000">)?</span> k <span style="color:#000000">:</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
    color<span style="color:#000000">.</span>r <span style="color:#000000">= (</span><span style="color:#0057ae">unsigned char</span><span style="color:#000000">)((</span>value <span style="color:#000000">-</span> value<span style="color:#000000">*</span>saturation<span style="color:#000000">*</span>k<span style="color:#000000">)*</span><span style="color:#b07e00">255.0</span>f<span style="color:#000000">);</span>
    <span style="color:#838183; font-style:italic">// Green channel</span>
    k <span style="color:#000000">=</span> <span style="color:#010181">fmodf</span><span style="color:#000000">((</span><span style="color:#b07e00">3.0</span>f <span style="color:#000000">+</span> hue<span style="color:#000000">/</span><span style="color:#b07e00">60.0</span>f<span style="color:#000000">),</span> <span style="color:#b07e00">6</span><span style="color:#000000">);</span>
    t <span style="color:#000000">=</span> <span style="color:#b07e00">4.0</span>f <span style="color:#000000">-</span> k<span style="color:#000000">;</span>
    k <span style="color:#000000">= (</span>t <span style="color:#000000">&lt;</span> k<span style="color:#000000">)?</span> t <span style="color:#000000">:</span> k<span style="color:#000000">;</span>
    k <span style="color:#000000">= (</span>k <span style="color:#000000">&lt;</span> <span style="color:#b07e00">1</span><span style="color:#000000">)?</span> k <span style="color:#000000">:</span> <span style="color:#b07e00">1</span><span style="color:#000000">;</span>
    k <span style="color:#000000">= (</span>k <span style="color:#000000">&gt;</span> <span style="color:#b07e00">0</span><span style="color:#000000">)?</span> k <span style="color:#000000">:</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
    color<span style="color:#000000">.</span>g <span style="color:#000000">= (</span><span style="color:#0057ae">unsigned char</span><span style="color:#000000">)((</span>value <span style="color:#000000">-</span> value<span style="color:#000000">*</span>saturation<span style="color:#000000">*</span>k<span style="color:#000000">)*</span><span style="color:#b07e00">255.0</span>f<span style="color:#000000">);</span>
    <span style="color:#838183; font-style:italic">// Blue channel</span>
    k <span style="color:#000000">=</span> <span style="color:#010181">fmodf</span><span style="color:#000000">((</span><span style="color:#b07e00">1.0</span>f <span style="color:#000000">+</span> hue<span style="color:#000000">/</span><span style="color:#b07e00">60.0</span>f<span style="color:#000000">),</span> <span style="color:#b07e00">6</span><span style="color:#000000">);</span>
    t <span style="color:#000000">=</span> <span style="color:#b07e00">4.0</span>f <span style="color:#000000">-</span> k<span style="color:#000000">;</span>
    k <span style="color:#000000">= (</span>t <span style="color:#000000">&lt;</span> k<span style="color:#000000">)?</span> t <span style="color:#000000">:</span> k<span style="color:#000000">;</span>
    k <span style="color:#000000">= (</span>k <span style="color:#000000">&lt;</span> <span style="color:#b07e00">1</span><span style="color:#000000">)?</span> k <span style="color:#000000">:</span> <span style="color:#b07e00">1</span><span style="color:#000000">;</span>
    k <span style="color:#000000">= (</span>k <span style="color:#000000">&gt;</span> <span style="color:#b07e00">0</span><span style="color:#000000">)?</span> k <span style="color:#000000">:</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
    color<span style="color:#000000">.</span>b <span style="color:#000000">= (</span><span style="color:#0057ae">unsigned char</span><span style="color:#000000">)((</span>value <span style="color:#000000">-</span> value<span style="color:#000000">*</span>saturation<span style="color:#000000">*</span>k<span style="color:#000000">)*</span><span style="color:#b07e00">255.0</span>f<span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">return</span> color<span style="color:#000000">;</span>
<span style="color:#000000">}</span>
