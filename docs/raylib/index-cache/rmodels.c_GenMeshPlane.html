Mesh <span style="color:#010181">GenMeshPlane</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span> width<span style="color:#000000">,</span> <span style="color:#0057ae">float</span> length<span style="color:#000000">,</span> <span style="color:#0057ae">int</span> resX<span style="color:#000000">,</span> <span style="color:#0057ae">int</span> resZ<span style="color:#000000">){</span>
    Mesh mesh <span style="color:#000000">= {</span> <span style="color:#b07e00">0</span> <span style="color:#000000">};</span>
<span style="color:#008200">#define CUSTOM_MESH_GEN_PLANE</span>
<span style="color:#008200">#if defined(CUSTOM_MESH_GEN_PLANE)</span>
    resX<span style="color:#000000">++;</span>
    resZ<span style="color:#000000">++;</span>
    <span style="color:#838183; font-style:italic">// Vertices definition</span>
    <span style="color:#0057ae">int</span> vertexCount <span style="color:#000000">=</span> resX<span style="color:#000000">*</span>resZ<span style="color:#000000">;</span> <span style="color:#838183; font-style:italic">// vertices get reused for the faces</span>
    Vector3 <span style="color:#000000">*</span>vertices <span style="color:#000000">= (</span>Vector3 <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>vertexCount<span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span>Vector3<span style="color:#000000">));</span>
    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> z <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> z <span style="color:#000000">&lt;</span> resZ<span style="color:#000000">;</span> z<span style="color:#000000">++)</span>
    <span style="color:#000000">{</span>
        <span style="color:#838183; font-style:italic">// [-length/2, length/2]</span>
        <span style="color:#0057ae">float</span> zPos <span style="color:#000000">= ((</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>z<span style="color:#000000">/(</span>resZ <span style="color:#000000">-</span> <span style="color:#b07e00">1</span><span style="color:#000000">) -</span> <span style="color:#b07e00">0.5</span>f<span style="color:#000000">)*</span>length<span style="color:#000000">;</span>
        <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> x <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> x <span style="color:#000000">&lt;</span> resX<span style="color:#000000">;</span> x<span style="color:#000000">++)</span>
        <span style="color:#000000">{</span>
            <span style="color:#838183; font-style:italic">// [-width/2, width/2]</span>
            <span style="color:#0057ae">float</span> xPos <span style="color:#000000">= ((</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>x<span style="color:#000000">/(</span>resX <span style="color:#000000">-</span> <span style="color:#b07e00">1</span><span style="color:#000000">) -</span> <span style="color:#b07e00">0.5</span>f<span style="color:#000000">)*</span>width<span style="color:#000000">;</span>
            vertices<span style="color:#000000">[</span>x <span style="color:#000000">+</span> z<span style="color:#000000">*</span>resX<span style="color:#000000">] = (</span>Vector3<span style="color:#000000">){</span> xPos<span style="color:#000000">,</span> <span style="color:#b07e00">0.0</span>f<span style="color:#000000">,</span> zPos <span style="color:#000000">};</span>
        <span style="color:#000000">}</span>
    <span style="color:#000000">}</span>
    <span style="color:#838183; font-style:italic">// Normals definition</span>
    Vector3 <span style="color:#000000">*</span>normals <span style="color:#000000">= (</span>Vector3 <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>vertexCount<span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span>Vector3<span style="color:#000000">));</span>
    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> n <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> n <span style="color:#000000">&lt;</span> vertexCount<span style="color:#000000">;</span> n<span style="color:#000000">++)</span> normals<span style="color:#000000">[</span>n<span style="color:#000000">] = (</span>Vector3<span style="color:#000000">){</span> <span style="color:#b07e00">0.0</span>f<span style="color:#000000">,</span> <span style="color:#b07e00">1.0</span>f<span style="color:#000000">,</span> <span style="color:#b07e00">0.0</span>f <span style="color:#000000">};</span>   <span style="color:#838183; font-style:italic">// Vector3.up;</span>
    <span style="color:#838183; font-style:italic">// TexCoords definition</span>
    Vector2 <span style="color:#000000">*</span>texcoords <span style="color:#000000">= (</span>Vector2 <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>vertexCount<span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span>Vector2<span style="color:#000000">));</span>
    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> v <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> v <span style="color:#000000">&lt;</span> resZ<span style="color:#000000">;</span> v<span style="color:#000000">++)</span>
    <span style="color:#000000">{</span>
        <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> u <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> u <span style="color:#000000">&lt;</span> resX<span style="color:#000000">;</span> u<span style="color:#000000">++)</span>
        <span style="color:#000000">{</span>
            texcoords<span style="color:#000000">[</span>u <span style="color:#000000">+</span> v<span style="color:#000000">*</span>resX<span style="color:#000000">] = (</span>Vector2<span style="color:#000000">){ (</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>u<span style="color:#000000">/(</span>resX <span style="color:#000000">-</span> <span style="color:#b07e00">1</span><span style="color:#000000">), (</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>v<span style="color:#000000">/(</span>resZ <span style="color:#000000">-</span> <span style="color:#b07e00">1</span><span style="color:#000000">) };</span>
        <span style="color:#000000">}</span>
    <span style="color:#000000">}</span>
    <span style="color:#838183; font-style:italic">// Triangles definition (indices)</span>
    <span style="color:#0057ae">int</span> numFaces <span style="color:#000000">= (</span>resX <span style="color:#000000">-</span> <span style="color:#b07e00">1</span><span style="color:#000000">)*(</span>resZ <span style="color:#000000">-</span> <span style="color:#b07e00">1</span><span style="color:#000000">);</span>
    <span style="color:#0057ae">int</span> <span style="color:#000000">*</span>triangles <span style="color:#000000">= (</span><span style="color:#0057ae">int</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>numFaces<span style="color:#000000">*</span><span style="color:#b07e00">6</span><span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span><span style="color:#000000">));</span>
    <span style="color:#0057ae">int</span> t <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> face <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> face <span style="color:#000000">&lt;</span> numFaces<span style="color:#000000">;</span> face<span style="color:#000000">++)</span>
    <span style="color:#000000">{</span>
        <span style="color:#838183; font-style:italic">// Retrieve lower left corner from face ind</span>
        <span style="color:#0057ae">int</span> i <span style="color:#000000">=</span> face <span style="color:#000000">% (</span>resX <span style="color:#000000">-</span> <span style="color:#b07e00">1</span><span style="color:#000000">) + (</span>face<span style="color:#000000">/(</span>resZ <span style="color:#000000">-</span> <span style="color:#b07e00">1</span><span style="color:#000000">)*</span>resX<span style="color:#000000">);</span>
        triangles<span style="color:#000000">[</span>t<span style="color:#000000">++] =</span> i <span style="color:#000000">+</span> resX<span style="color:#000000">;</span>
        triangles<span style="color:#000000">[</span>t<span style="color:#000000">++] =</span> i <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">;</span>
        triangles<span style="color:#000000">[</span>t<span style="color:#000000">++] =</span> i<span style="color:#000000">;</span>
        triangles<span style="color:#000000">[</span>t<span style="color:#000000">++] =</span> i <span style="color:#000000">+</span> resX<span style="color:#000000">;</span>
        triangles<span style="color:#000000">[</span>t<span style="color:#000000">++] =</span> i <span style="color:#000000">+</span> resX <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">;</span>
        triangles<span style="color:#000000">[</span>t<span style="color:#000000">++] =</span> i <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">;</span>
    <span style="color:#000000">}</span>
    mesh<span style="color:#000000">.</span>vertexCount <span style="color:#000000">=</span> vertexCount<span style="color:#000000">;</span>
    mesh<span style="color:#000000">.</span>triangleCount <span style="color:#000000">=</span> numFaces<span style="color:#000000">*</span><span style="color:#b07e00">2</span><span style="color:#000000">;</span>
    mesh<span style="color:#000000">.</span>vertices <span style="color:#000000">= (</span><span style="color:#0057ae">float</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>mesh<span style="color:#000000">.</span>vertexCount<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span><span style="color:#000000">));</span>
    mesh<span style="color:#000000">.</span>texcoords <span style="color:#000000">= (</span><span style="color:#0057ae">float</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>mesh<span style="color:#000000">.</span>vertexCount<span style="color:#000000">*</span><span style="color:#b07e00">2</span><span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span><span style="color:#000000">));</span>
    mesh<span style="color:#000000">.</span>normals <span style="color:#000000">= (</span><span style="color:#0057ae">float</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>mesh<span style="color:#000000">.</span>vertexCount<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span><span style="color:#000000">));</span>
    mesh<span style="color:#000000">.</span>indices <span style="color:#000000">= (</span><span style="color:#0057ae">unsigned short</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>mesh<span style="color:#000000">.</span>triangleCount<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">unsigned short</span><span style="color:#000000">));</span>
    <span style="color:#838183; font-style:italic">// Mesh vertices position array</span>
    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> i <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> i <span style="color:#000000">&lt;</span> mesh<span style="color:#000000">.</span>vertexCount<span style="color:#000000">;</span> i<span style="color:#000000">++)</span>
    <span style="color:#000000">{</span>
        mesh<span style="color:#000000">.</span>vertices<span style="color:#000000">[</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span>i<span style="color:#000000">] =</span> vertices<span style="color:#000000">[</span>i<span style="color:#000000">].</span>x<span style="color:#000000">;</span>
        mesh<span style="color:#000000">.</span>vertices<span style="color:#000000">[</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span>i <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">] =</span> vertices<span style="color:#000000">[</span>i<span style="color:#000000">].</span>y<span style="color:#000000">;</span>
        mesh<span style="color:#000000">.</span>vertices<span style="color:#000000">[</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span>i <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">] =</span> vertices<span style="color:#000000">[</span>i<span style="color:#000000">].</span>z<span style="color:#000000">;</span>
    <span style="color:#000000">}</span>
    <span style="color:#838183; font-style:italic">// Mesh texcoords array</span>
    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> i <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> i <span style="color:#000000">&lt;</span> mesh<span style="color:#000000">.</span>vertexCount<span style="color:#000000">;</span> i<span style="color:#000000">++)</span>
    <span style="color:#000000">{</span>
        mesh<span style="color:#000000">.</span>texcoords<span style="color:#000000">[</span><span style="color:#b07e00">2</span><span style="color:#000000">*</span>i<span style="color:#000000">] =</span> texcoords<span style="color:#000000">[</span>i<span style="color:#000000">].</span>x<span style="color:#000000">;</span>
        mesh<span style="color:#000000">.</span>texcoords<span style="color:#000000">[</span><span style="color:#b07e00">2</span><span style="color:#000000">*</span>i <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">] =</span> texcoords<span style="color:#000000">[</span>i<span style="color:#000000">].</span>y<span style="color:#000000">;</span>
    <span style="color:#000000">}</span>
    <span style="color:#838183; font-style:italic">// Mesh normals array</span>
    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> i <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> i <span style="color:#000000">&lt;</span> mesh<span style="color:#000000">.</span>vertexCount<span style="color:#000000">;</span> i<span style="color:#000000">++)</span>
    <span style="color:#000000">{</span>
        mesh<span style="color:#000000">.</span>normals<span style="color:#000000">[</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span>i<span style="color:#000000">] =</span> normals<span style="color:#000000">[</span>i<span style="color:#000000">].</span>x<span style="color:#000000">;</span>
        mesh<span style="color:#000000">.</span>normals<span style="color:#000000">[</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span>i <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">] =</span> normals<span style="color:#000000">[</span>i<span style="color:#000000">].</span>y<span style="color:#000000">;</span>
        mesh<span style="color:#000000">.</span>normals<span style="color:#000000">[</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span>i <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">] =</span> normals<span style="color:#000000">[</span>i<span style="color:#000000">].</span>z<span style="color:#000000">;</span>
    <span style="color:#000000">}</span>
    <span style="color:#838183; font-style:italic">// Mesh indices array initialization</span>
    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> i <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> i <span style="color:#000000">&lt;</span> mesh<span style="color:#000000">.</span>triangleCount<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">;</span> i<span style="color:#000000">++)</span> mesh<span style="color:#000000">.</span>indices<span style="color:#000000">[</span>i<span style="color:#000000">] =</span> triangles<span style="color:#000000">[</span>i<span style="color:#000000">];</span>
    <span style="color:#010181">RL_FREE</span><span style="color:#000000">(</span>vertices<span style="color:#000000">);</span>
    <span style="color:#010181">RL_FREE</span><span style="color:#000000">(</span>normals<span style="color:#000000">);</span>
    <span style="color:#010181">RL_FREE</span><span style="color:#000000">(</span>texcoords<span style="color:#000000">);</span>
    <span style="color:#010181">RL_FREE</span><span style="color:#000000">(</span>triangles<span style="color:#000000">);</span>
<span style="color:#008200">#else</span>       <span style="color:#838183; font-style:italic">// Use par_shapes library to generate plane mesh</span>
<span style="color:#008200"></span>    par_shapes_mesh <span style="color:#000000">*</span>plane <span style="color:#000000">=</span> <span style="color:#010181">par_shapes_create_plane</span><span style="color:#000000">(</span>resX<span style="color:#000000">,</span> resZ<span style="color:#000000">);</span>   <span style="color:#838183; font-style:italic">// No normals/texcoords generated!!!</span>
    <span style="color:#010181">par_shapes_scale</span><span style="color:#000000">(</span>plane<span style="color:#000000">,</span> width<span style="color:#000000">,</span> length<span style="color:#000000">,</span> <span style="color:#b07e00">1.0</span>f<span style="color:#000000">);</span>
    <span style="color:#010181">par_shapes_rotate</span><span style="color:#000000">(</span>plane<span style="color:#000000">, -</span>PI<span style="color:#000000">/</span><span style="color:#b07e00">2.0</span>f<span style="color:#000000">, (</span><span style="color:#0057ae">float</span><span style="color:#000000">[]){</span> <span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span> <span style="color:#000000">});</span>
    <span style="color:#010181">par_shapes_translate</span><span style="color:#000000">(</span>plane<span style="color:#000000">, -</span>width<span style="color:#000000">/</span><span style="color:#b07e00">2</span><span style="color:#000000">,</span> <span style="color:#b07e00">0.0</span>f<span style="color:#000000">,</span> length<span style="color:#000000">/</span><span style="color:#b07e00">2</span><span style="color:#000000">);</span>
    mesh<span style="color:#000000">.</span>vertices <span style="color:#000000">= (</span><span style="color:#0057ae">float</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>plane<span style="color:#000000">-&gt;</span>ntriangles<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span><span style="color:#000000">));</span>
    mesh<span style="color:#000000">.</span>texcoords <span style="color:#000000">= (</span><span style="color:#0057ae">float</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>plane<span style="color:#000000">-&gt;</span>ntriangles<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#b07e00">2</span><span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span><span style="color:#000000">));</span>
    mesh<span style="color:#000000">.</span>normals <span style="color:#000000">= (</span><span style="color:#0057ae">float</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>plane<span style="color:#000000">-&gt;</span>ntriangles<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">float</span><span style="color:#000000">));</span>
    mesh<span style="color:#000000">.</span>vertexCount <span style="color:#000000">=</span> plane<span style="color:#000000">-&gt;</span>ntriangles<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">;</span>
    mesh<span style="color:#000000">.</span>triangleCount <span style="color:#000000">=</span> plane<span style="color:#000000">-&gt;</span>ntriangles<span style="color:#000000">;</span>
    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">int</span> k <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> k <span style="color:#000000">&lt;</span> mesh<span style="color:#000000">.</span>vertexCount<span style="color:#000000">;</span> k<span style="color:#000000">++)</span>
    <span style="color:#000000">{</span>
        mesh<span style="color:#000000">.</span>vertices<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">] =</span> plane<span style="color:#000000">-&gt;</span>points<span style="color:#000000">[</span>plane<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">3</span><span style="color:#000000">];</span>
        mesh<span style="color:#000000">.</span>vertices<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">] =</span> plane<span style="color:#000000">-&gt;</span>points<span style="color:#000000">[</span>plane<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">];</span>
        mesh<span style="color:#000000">.</span>vertices<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">] =</span> plane<span style="color:#000000">-&gt;</span>points<span style="color:#000000">[</span>plane<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">];</span>
        mesh<span style="color:#000000">.</span>normals<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">3</span><span style="color:#000000">] =</span> plane<span style="color:#000000">-&gt;</span>normals<span style="color:#000000">[</span>plane<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">3</span><span style="color:#000000">];</span>
        mesh<span style="color:#000000">.</span>normals<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">] =</span> plane<span style="color:#000000">-&gt;</span>normals<span style="color:#000000">[</span>plane<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">];</span>
        mesh<span style="color:#000000">.</span>normals<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">] =</span> plane<span style="color:#000000">-&gt;</span>normals<span style="color:#000000">[</span>plane<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">3</span> <span style="color:#000000">+</span> <span style="color:#b07e00">2</span><span style="color:#000000">];</span>
        mesh<span style="color:#000000">.</span>texcoords<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">2</span><span style="color:#000000">] =</span> plane<span style="color:#000000">-&gt;</span>tcoords<span style="color:#000000">[</span>plane<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">2</span><span style="color:#000000">];</span>
        mesh<span style="color:#000000">.</span>texcoords<span style="color:#000000">[</span>k<span style="color:#000000">*</span><span style="color:#b07e00">2</span> <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">] =</span> plane<span style="color:#000000">-&gt;</span>tcoords<span style="color:#000000">[</span>plane<span style="color:#000000">-&gt;</span>triangles<span style="color:#000000">[</span>k<span style="color:#000000">]*</span><span style="color:#b07e00">2</span> <span style="color:#000000">+</span> <span style="color:#b07e00">1</span><span style="color:#000000">];</span>
    <span style="color:#000000">}</span>
    <span style="color:#010181">par_shapes_free_mesh</span><span style="color:#000000">(</span>plane<span style="color:#000000">);</span>
<span style="color:#008200">#endif</span>
    <span style="color:#838183; font-style:italic">// Upload vertex data to GPU (static mesh)</span>
    <span style="color:#010181">UploadMesh</span><span style="color:#000000">(&amp;</span>mesh<span style="color:#000000">,</span> <span style="color:#000000; font-weight:bold">false</span><span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">return</span> mesh<span style="color:#000000">;</span>
<span style="color:#000000">}</span>
