VrStereoConfig <span style="color:#010181">LoadVrStereoConfig</span><span style="color:#000000">(</span>VrDeviceInfo device<span style="color:#000000">){</span>
    VrStereoConfig config <span style="color:#000000">= {</span> <span style="color:#b07e00">0</span> <span style="color:#000000">};</span>
    <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">((</span><span style="color:#010181">rlGetVersion</span><span style="color:#000000">() ==</span> RL_OPENGL_33<span style="color:#000000">) || (</span><span style="color:#010181">rlGetVersion</span><span style="color:#000000">() ==</span> RL_OPENGL_ES_20<span style="color:#000000">))</span>
    <span style="color:#000000">{</span>
        <span style="color:#838183; font-style:italic">// Compute aspect ratio</span>
        <span style="color:#0057ae">float</span> aspect <span style="color:#000000">= ((</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>device<span style="color:#000000">.</span>hResolution<span style="color:#000000">*</span><span style="color:#b07e00">0.5</span>f<span style="color:#000000">)/(</span><span style="color:#0057ae">float</span><span style="color:#000000">)</span>device<span style="color:#000000">.</span>vResolution<span style="color:#000000">;</span>
        <span style="color:#838183; font-style:italic">// Compute lens parameters</span>
        <span style="color:#0057ae">float</span> lensShift <span style="color:#000000">= (</span>device<span style="color:#000000">.</span>hScreenSize<span style="color:#000000">*</span><span style="color:#b07e00">0.25</span>f <span style="color:#000000">-</span> device<span style="color:#000000">.</span>lensSeparationDistance<span style="color:#000000">*</span><span style="color:#b07e00">0.5</span>f<span style="color:#000000">)/</span>device<span style="color:#000000">.</span>hScreenSize<span style="color:#000000">;</span>
        config<span style="color:#000000">.</span>leftLensCenter<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">] =</span> <span style="color:#b07e00">0.25</span>f <span style="color:#000000">+</span> lensShift<span style="color:#000000">;</span>
        config<span style="color:#000000">.</span>leftLensCenter<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">] =</span> <span style="color:#b07e00">0.5</span>f<span style="color:#000000">;</span>
        config<span style="color:#000000">.</span>rightLensCenter<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">] =</span> <span style="color:#b07e00">0.75</span>f <span style="color:#000000">-</span> lensShift<span style="color:#000000">;</span>
        config<span style="color:#000000">.</span>rightLensCenter<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">] =</span> <span style="color:#b07e00">0.5</span>f<span style="color:#000000">;</span>
        config<span style="color:#000000">.</span>leftScreenCenter<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">] =</span> <span style="color:#b07e00">0.25</span>f<span style="color:#000000">;</span>
        config<span style="color:#000000">.</span>leftScreenCenter<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">] =</span> <span style="color:#b07e00">0.5</span>f<span style="color:#000000">;</span>
        config<span style="color:#000000">.</span>rightScreenCenter<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">] =</span> <span style="color:#b07e00">0.75</span>f<span style="color:#000000">;</span>
        config<span style="color:#000000">.</span>rightScreenCenter<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">] =</span> <span style="color:#b07e00">0.5</span>f<span style="color:#000000">;</span>
        <span style="color:#838183; font-style:italic">// Compute distortion scale parameters</span>
        <span style="color:#838183; font-style:italic">// NOTE: To get lens max radius, lensShift must be normalized to [-1..1]</span>
        <span style="color:#0057ae">float</span> lensRadius <span style="color:#000000">=</span> <span style="color:#010181">fabsf</span><span style="color:#000000">(-</span><span style="color:#b07e00">1.0</span>f <span style="color:#000000">-</span> <span style="color:#b07e00">4.0</span>f<span style="color:#000000">*</span>lensShift<span style="color:#000000">);</span>
        <span style="color:#0057ae">float</span> lensRadiusSq <span style="color:#000000">=</span> lensRadius<span style="color:#000000">*</span>lensRadius<span style="color:#000000">;</span>
        <span style="color:#0057ae">float</span> distortionScale <span style="color:#000000">=</span> device<span style="color:#000000">.</span>lensDistortionValues<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">] +</span>
                                device<span style="color:#000000">.</span>lensDistortionValues<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">]*</span>lensRadiusSq <span style="color:#000000">+</span>
                                device<span style="color:#000000">.</span>lensDistortionValues<span style="color:#000000">[</span><span style="color:#b07e00">2</span><span style="color:#000000">]*</span>lensRadiusSq<span style="color:#000000">*</span>lensRadiusSq <span style="color:#000000">+</span>
                                device<span style="color:#000000">.</span>lensDistortionValues<span style="color:#000000">[</span><span style="color:#b07e00">3</span><span style="color:#000000">]*</span>lensRadiusSq<span style="color:#000000">*</span>lensRadiusSq<span style="color:#000000">*</span>lensRadiusSq<span style="color:#000000">;</span>
        <span style="color:#0057ae">float</span> normScreenWidth <span style="color:#000000">=</span> <span style="color:#b07e00">0.5</span>f<span style="color:#000000">;</span>
        <span style="color:#0057ae">float</span> normScreenHeight <span style="color:#000000">=</span> <span style="color:#b07e00">1.0</span>f<span style="color:#000000">;</span>
        config<span style="color:#000000">.</span>scaleIn<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">] =</span> <span style="color:#b07e00">2.0</span>f<span style="color:#000000">/</span>normScreenWidth<span style="color:#000000">;</span>
        config<span style="color:#000000">.</span>scaleIn<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">] =</span> <span style="color:#b07e00">2.0</span>f<span style="color:#000000">/</span>normScreenHeight<span style="color:#000000">/</span>aspect<span style="color:#000000">;</span>
        config<span style="color:#000000">.</span>scale<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">] =</span> normScreenWidth<span style="color:#000000">*</span><span style="color:#b07e00">0.5</span>f<span style="color:#000000">/</span>distortionScale<span style="color:#000000">;</span>
        config<span style="color:#000000">.</span>scale<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">] =</span> normScreenHeight<span style="color:#000000">*</span><span style="color:#b07e00">0.5</span>f<span style="color:#000000">*</span>aspect<span style="color:#000000">/</span>distortionScale<span style="color:#000000">;</span>
        <span style="color:#838183; font-style:italic">// Fovy is normally computed with: 2*atan2f(device.vScreenSize, 2*device.eyeToScreenDistance)</span>
        <span style="color:#838183; font-style:italic">// ...but with lens distortion it is increased (see Oculus SDK Documentation)</span>
        <span style="color:#0057ae">float</span> fovy <span style="color:#000000">=</span> <span style="color:#b07e00">2.0</span>f<span style="color:#000000">*</span><span style="color:#010181">atan2f</span><span style="color:#000000">(</span>device<span style="color:#000000">.</span>vScreenSize<span style="color:#000000">*</span><span style="color:#b07e00">0.5</span>f<span style="color:#000000">*</span>distortionScale<span style="color:#000000">,</span> device<span style="color:#000000">.</span>eyeToScreenDistance<span style="color:#000000">);</span>     <span style="color:#838183; font-style:italic">// Really need distortionScale?</span>
       <span style="color:#838183; font-style:italic">// float fovy = 2.0f*(float)atan2f(device.vScreenSize*0.5f, device.eyeToScreenDistance);</span>
        <span style="color:#838183; font-style:italic">// Compute camera projection matrices</span>
        <span style="color:#0057ae">float</span> projOffset <span style="color:#000000">=</span> <span style="color:#b07e00">4.0</span>f<span style="color:#000000">*</span>lensShift<span style="color:#000000">;</span>      <span style="color:#838183; font-style:italic">// Scaled to projection space coordinates [-1..1]</span>
        Matrix proj <span style="color:#000000">=</span> <span style="color:#010181">MatrixPerspective</span><span style="color:#000000">(</span>fovy<span style="color:#000000">,</span> aspect<span style="color:#000000">,</span> RL_CULL_DISTANCE_NEAR<span style="color:#000000">,</span> RL_CULL_DISTANCE_FAR<span style="color:#000000">);</span>
        config<span style="color:#000000">.</span>projection<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">] =</span> <span style="color:#010181">MatrixMultiply</span><span style="color:#000000">(</span>proj<span style="color:#000000">,</span> <span style="color:#010181">MatrixTranslate</span><span style="color:#000000">(</span>projOffset<span style="color:#000000">,</span> <span style="color:#b07e00">0.0</span>f<span style="color:#000000">,</span> <span style="color:#b07e00">0.0</span>f<span style="color:#000000">));</span>
        config<span style="color:#000000">.</span>projection<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">] =</span> <span style="color:#010181">MatrixMultiply</span><span style="color:#000000">(</span>proj<span style="color:#000000">,</span> <span style="color:#010181">MatrixTranslate</span><span style="color:#000000">(-</span>projOffset<span style="color:#000000">,</span> <span style="color:#b07e00">0.0</span>f<span style="color:#000000">,</span> <span style="color:#b07e00">0.0</span>f<span style="color:#000000">));</span>
        <span style="color:#838183; font-style:italic">// Compute camera transformation matrices</span>
        <span style="color:#838183; font-style:italic">// NOTE: Camera movement might seem more natural if we model the head.</span>
        <span style="color:#838183; font-style:italic">// Our axis of rotation is the base of our head, so we might want to add</span>
        <span style="color:#838183; font-style:italic">// some y (base of head to eye level) and -z (center of head to eye protrusion) to the camera positions.</span>
        config<span style="color:#000000">.</span>viewOffset<span style="color:#000000">[</span><span style="color:#b07e00">0</span><span style="color:#000000">] =</span> <span style="color:#010181">MatrixTranslate</span><span style="color:#000000">(-</span>device<span style="color:#000000">.</span>interpupillaryDistance<span style="color:#000000">*</span><span style="color:#b07e00">0.5</span>f<span style="color:#000000">,</span> <span style="color:#b07e00">0.075</span>f<span style="color:#000000">,</span> <span style="color:#b07e00">0.045</span>f<span style="color:#000000">);</span>
        config<span style="color:#000000">.</span>viewOffset<span style="color:#000000">[</span><span style="color:#b07e00">1</span><span style="color:#000000">] =</span> <span style="color:#010181">MatrixTranslate</span><span style="color:#000000">(</span>device<span style="color:#000000">.</span>interpupillaryDistance<span style="color:#000000">*</span><span style="color:#b07e00">0.5</span>f<span style="color:#000000">,</span> <span style="color:#b07e00">0.075</span>f<span style="color:#000000">,</span> <span style="color:#b07e00">0.045</span>f<span style="color:#000000">);</span>
        <span style="color:#838183; font-style:italic">// Compute eyes Viewports</span>
        <span style="color:#838183; font-style:italic">/*</span>
<span style="color:#838183; font-style:italic">        config.eyeViewportRight[0] = 0;</span>
<span style="color:#838183; font-style:italic">        config.eyeViewportRight[1] = 0;</span>
<span style="color:#838183; font-style:italic">        config.eyeViewportRight[2] = device.hResolution/2;</span>
<span style="color:#838183; font-style:italic">        config.eyeViewportRight[3] = device.vResolution;</span>
<span style="color:#838183; font-style:italic">        config.eyeViewportLeft[0] = device.hResolution/2;</span>
<span style="color:#838183; font-style:italic">        config.eyeViewportLeft[1] = 0;</span>
<span style="color:#838183; font-style:italic">        config.eyeViewportLeft[2] = device.hResolution/2;</span>
<span style="color:#838183; font-style:italic">        config.eyeViewportLeft[3] = device.vResolution;</span>
<span style="color:#838183; font-style:italic">        */</span>
    <span style="color:#000000">}</span>
    <span style="color:#000000; font-weight:bold">else</span> <span style="color:#010181">TRACELOG</span><span style="color:#000000">(</span>LOG_WARNING<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;RLGL: VR Simulator not supported on OpenGL 1.1&quot;</span><span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">return</span> config<span style="color:#000000">;</span>
<span style="color:#000000">}</span>
