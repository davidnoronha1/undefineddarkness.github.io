Wave <span style="color:#010181">LoadWaveFromMemory</span><span style="color:#000000">(</span><span style="color:#0057ae">const char</span> <span style="color:#000000">*</span>fileType<span style="color:#000000">,</span> <span style="color:#0057ae">const unsigned char</span> <span style="color:#000000">*</span>fileData<span style="color:#000000">,</span> <span style="color:#0057ae">int</span> dataSize<span style="color:#000000">){</span>
    Wave wave <span style="color:#000000">= {</span> <span style="color:#b07e00">0</span> <span style="color:#000000">};</span>
    <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span><span style="color:#000000; font-weight:bold">false</span><span style="color:#000000">) { }</span>
<span style="color:#008200">#if defined(SUPPORT_FILEFORMAT_WAV)</span>
    <span style="color:#000000; font-weight:bold">else if</span> <span style="color:#000000">((</span><span style="color:#010181">strcmp</span><span style="color:#000000">(</span>fileType<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;.wav&quot;</span><span style="color:#000000">) ==</span> <span style="color:#b07e00">0</span><span style="color:#000000">) || (</span><span style="color:#010181">strcmp</span><span style="color:#000000">(</span>fileType<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;.WAV&quot;</span><span style="color:#000000">) ==</span> <span style="color:#b07e00">0</span><span style="color:#000000">))</span>
    <span style="color:#000000">{</span>
        drwav wav <span style="color:#000000">= {</span> <span style="color:#b07e00">0</span> <span style="color:#000000">};</span>
        <span style="color:#0057ae">bool</span> success <span style="color:#000000">=</span> <span style="color:#010181">drwav_init_memory</span><span style="color:#000000">(&amp;</span>wav<span style="color:#000000">,</span> fileData<span style="color:#000000">,</span> dataSize<span style="color:#000000">,</span> NULL<span style="color:#000000">);</span>
        <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>success<span style="color:#000000">)</span>
        <span style="color:#000000">{</span>
            wave<span style="color:#000000">.</span>frameCount <span style="color:#000000">= (</span><span style="color:#0057ae">unsigned int</span><span style="color:#000000">)</span>wav<span style="color:#000000">.</span>totalPCMFrameCount<span style="color:#000000">;</span>
            wave<span style="color:#000000">.</span>sampleRate <span style="color:#000000">=</span> wav<span style="color:#000000">.</span>sampleRate<span style="color:#000000">;</span>
            wave<span style="color:#000000">.</span>sampleSize <span style="color:#000000">=</span> <span style="color:#b07e00">16</span><span style="color:#000000">;</span>
            wave<span style="color:#000000">.</span>channels <span style="color:#000000">=</span> wav<span style="color:#000000">.</span>channels<span style="color:#000000">;</span>
            wave<span style="color:#000000">.</span>data <span style="color:#000000">= (</span><span style="color:#0057ae">short</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>wave<span style="color:#000000">.</span>frameCount<span style="color:#000000">*</span>wave<span style="color:#000000">.</span>channels<span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">short</span><span style="color:#000000">));</span>
            <span style="color:#838183; font-style:italic">// NOTE: We are forcing conversion to 16bit sample size on reading</span>
            <span style="color:#010181">drwav_read_pcm_frames_s16</span><span style="color:#000000">(&amp;</span>wav<span style="color:#000000">,</span> wav<span style="color:#000000">.</span>totalPCMFrameCount<span style="color:#000000">,</span> wave<span style="color:#000000">.</span>data<span style="color:#000000">);</span>
        <span style="color:#000000">}</span>
        <span style="color:#000000; font-weight:bold">else</span> <span style="color:#010181">TRACELOG</span><span style="color:#000000">(</span>LOG_WARNING<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;WAVE: Failed to load WAV data&quot;</span><span style="color:#000000">);</span>
        <span style="color:#010181">drwav_uninit</span><span style="color:#000000">(&amp;</span>wav<span style="color:#000000">);</span>
    <span style="color:#000000">}</span>
<span style="color:#008200">#endif</span>
<span style="color:#008200">#if defined(SUPPORT_FILEFORMAT_OGG)</span>
    <span style="color:#000000; font-weight:bold">else if</span> <span style="color:#000000">((</span><span style="color:#010181">strcmp</span><span style="color:#000000">(</span>fileType<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;.ogg&quot;</span><span style="color:#000000">) ==</span> <span style="color:#b07e00">0</span><span style="color:#000000">) || (</span><span style="color:#010181">strcmp</span><span style="color:#000000">(</span>fileType<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;.OGG&quot;</span><span style="color:#000000">) ==</span> <span style="color:#b07e00">0</span><span style="color:#000000">))</span>
    <span style="color:#000000">{</span>
        stb_vorbis <span style="color:#000000">*</span>oggData <span style="color:#000000">=</span> <span style="color:#010181">stb_vorbis_open_memory</span><span style="color:#000000">((</span><span style="color:#0057ae">unsigned char</span> <span style="color:#000000">*)</span>fileData<span style="color:#000000">,</span> dataSize<span style="color:#000000">,</span> NULL<span style="color:#000000">,</span> NULL<span style="color:#000000">);</span>
        <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>oggData <span style="color:#000000">!=</span> NULL<span style="color:#000000">)</span>
        <span style="color:#000000">{</span>
            stb_vorbis_info info <span style="color:#000000">=</span> <span style="color:#010181">stb_vorbis_get_info</span><span style="color:#000000">(</span>oggData<span style="color:#000000">);</span>
            wave<span style="color:#000000">.</span>sampleRate <span style="color:#000000">=</span> info<span style="color:#000000">.</span>sample_rate<span style="color:#000000">;</span>
            wave<span style="color:#000000">.</span>sampleSize <span style="color:#000000">=</span> <span style="color:#b07e00">16</span><span style="color:#000000">;</span>       <span style="color:#838183; font-style:italic">// By default, ogg data is 16 bit per sample (short)</span>
            wave<span style="color:#000000">.</span>channels <span style="color:#000000">=</span> info<span style="color:#000000">.</span>channels<span style="color:#000000">;</span>
            wave<span style="color:#000000">.</span>frameCount <span style="color:#000000">= (</span><span style="color:#0057ae">unsigned int</span><span style="color:#000000">)</span><span style="color:#010181">stb_vorbis_stream_length_in_samples</span><span style="color:#000000">(</span>oggData<span style="color:#000000">);</span>  <span style="color:#838183; font-style:italic">// NOTE: It returns frames!</span>
            wave<span style="color:#000000">.</span>data <span style="color:#000000">= (</span><span style="color:#0057ae">short</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_MALLOC</span><span style="color:#000000">(</span>wave<span style="color:#000000">.</span>frameCount<span style="color:#000000">*</span>wave<span style="color:#000000">.</span>channels<span style="color:#000000">*</span><span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">short</span><span style="color:#000000">));</span>
            <span style="color:#838183; font-style:italic">// NOTE: Get the number of samples to process (be careful! we ask for number of shorts, not bytes!)</span>
            <span style="color:#010181">stb_vorbis_get_samples_short_interleaved</span><span style="color:#000000">(</span>oggData<span style="color:#000000">,</span> info<span style="color:#000000">.</span>channels<span style="color:#000000">, (</span><span style="color:#0057ae">short</span> <span style="color:#000000">*)</span>wave<span style="color:#000000">.</span>data<span style="color:#000000">,</span> wave<span style="color:#000000">.</span>frameCount<span style="color:#000000">*</span>wave<span style="color:#000000">.</span>channels<span style="color:#000000">);</span>
            <span style="color:#010181">stb_vorbis_close</span><span style="color:#000000">(</span>oggData<span style="color:#000000">);</span>
        <span style="color:#000000">}</span>
        <span style="color:#000000; font-weight:bold">else</span> <span style="color:#010181">TRACELOG</span><span style="color:#000000">(</span>LOG_WARNING<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;WAVE: Failed to load OGG data&quot;</span><span style="color:#000000">);</span>
    <span style="color:#000000">}</span>
<span style="color:#008200">#endif</span>
<span style="color:#008200">#if defined(SUPPORT_FILEFORMAT_MP3)</span>
    <span style="color:#000000; font-weight:bold">else if</span> <span style="color:#000000">((</span><span style="color:#010181">strcmp</span><span style="color:#000000">(</span>fileType<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;.mp3&quot;</span><span style="color:#000000">) ==</span> <span style="color:#b07e00">0</span><span style="color:#000000">) || (</span><span style="color:#010181">strcmp</span><span style="color:#000000">(</span>fileType<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;.MP3&quot;</span><span style="color:#000000">) ==</span> <span style="color:#b07e00">0</span><span style="color:#000000">))</span>
    <span style="color:#000000">{</span>
        drmp3_config config <span style="color:#000000">= {</span> <span style="color:#b07e00">0</span> <span style="color:#000000">};</span>
        <span style="color:#0057ae">unsigned long long int</span> totalFrameCount <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
        <span style="color:#838183; font-style:italic">// NOTE: We are forcing conversion to 32bit float sample size on reading</span>
        wave<span style="color:#000000">.</span>data <span style="color:#000000">=</span> <span style="color:#010181">drmp3_open_memory_and_read_pcm_frames_f32</span><span style="color:#000000">(</span>fileData<span style="color:#000000">,</span> dataSize<span style="color:#000000">, &amp;</span>config<span style="color:#000000">, &amp;</span>totalFrameCount<span style="color:#000000">,</span> NULL<span style="color:#000000">);</span>
        wave<span style="color:#000000">.</span>sampleSize <span style="color:#000000">=</span> <span style="color:#b07e00">32</span><span style="color:#000000">;</span>
        <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>wave<span style="color:#000000">.</span>data <span style="color:#000000">!=</span> NULL<span style="color:#000000">)</span>
        <span style="color:#000000">{</span>
            wave<span style="color:#000000">.</span>channels <span style="color:#000000">=</span> config<span style="color:#000000">.</span>channels<span style="color:#000000">;</span>
            wave<span style="color:#000000">.</span>sampleRate <span style="color:#000000">=</span> config<span style="color:#000000">.</span>sampleRate<span style="color:#000000">;</span>
            wave<span style="color:#000000">.</span>frameCount <span style="color:#000000">= (</span><span style="color:#0057ae">int</span><span style="color:#000000">)</span>totalFrameCount<span style="color:#000000">;</span>
        <span style="color:#000000">}</span>
        <span style="color:#000000; font-weight:bold">else</span> <span style="color:#010181">TRACELOG</span><span style="color:#000000">(</span>LOG_WARNING<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;WAVE: Failed to load MP3 data&quot;</span><span style="color:#000000">);</span>
    <span style="color:#000000">}</span>
<span style="color:#008200">#endif</span>
<span style="color:#008200">#if defined(SUPPORT_FILEFORMAT_QOA)</span>
    <span style="color:#000000; font-weight:bold">else if</span> <span style="color:#000000">((</span><span style="color:#010181">strcmp</span><span style="color:#000000">(</span>fileType<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;.qoa&quot;</span><span style="color:#000000">) ==</span> <span style="color:#b07e00">0</span><span style="color:#000000">) || (</span><span style="color:#010181">strcmp</span><span style="color:#000000">(</span>fileType<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;.QOA&quot;</span><span style="color:#000000">) ==</span> <span style="color:#b07e00">0</span><span style="color:#000000">))</span>
    <span style="color:#000000">{</span>
        qoa_desc qoa <span style="color:#000000">= {</span> <span style="color:#b07e00">0</span> <span style="color:#000000">};</span>
        <span style="color:#838183; font-style:italic">// NOTE: Returned sample data is always 16 bit?</span>
        wave<span style="color:#000000">.</span>data <span style="color:#000000">=</span> <span style="color:#010181">qoa_decode</span><span style="color:#000000">(</span>fileData<span style="color:#000000">,</span> dataSize<span style="color:#000000">, &amp;</span>qoa<span style="color:#000000">);</span>
        wave<span style="color:#000000">.</span>sampleSize <span style="color:#000000">=</span> <span style="color:#b07e00">16</span><span style="color:#000000">;</span>
        <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>wave<span style="color:#000000">.</span>data <span style="color:#000000">!=</span> NULL<span style="color:#000000">)</span>
        <span style="color:#000000">{</span>
            wave<span style="color:#000000">.</span>channels <span style="color:#000000">=</span> qoa<span style="color:#000000">.</span>channels<span style="color:#000000">;</span>
            wave<span style="color:#000000">.</span>sampleRate <span style="color:#000000">=</span> qoa<span style="color:#000000">.</span>samplerate<span style="color:#000000">;</span>
            wave<span style="color:#000000">.</span>frameCount <span style="color:#000000">=</span> qoa<span style="color:#000000">.</span>samples<span style="color:#000000">;</span>
        <span style="color:#000000">}</span>
        <span style="color:#000000; font-weight:bold">else</span> <span style="color:#010181">TRACELOG</span><span style="color:#000000">(</span>LOG_WARNING<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;WAVE: Failed to load QOA data&quot;</span><span style="color:#000000">);</span>
    <span style="color:#000000">}</span>
<span style="color:#008200">#endif</span>
<span style="color:#008200">#if defined(SUPPORT_FILEFORMAT_FLAC)</span>
    <span style="color:#000000; font-weight:bold">else if</span> <span style="color:#000000">((</span><span style="color:#010181">strcmp</span><span style="color:#000000">(</span>fileType<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;.flac&quot;</span><span style="color:#000000">) ==</span> <span style="color:#b07e00">0</span><span style="color:#000000">) || (</span><span style="color:#010181">strcmp</span><span style="color:#000000">(</span>fileType<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;.FLAC&quot;</span><span style="color:#000000">) ==</span> <span style="color:#b07e00">0</span><span style="color:#000000">))</span>
    <span style="color:#000000">{</span>
        <span style="color:#0057ae">unsigned long long int</span> totalFrameCount <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
        <span style="color:#838183; font-style:italic">// NOTE: We are forcing conversion to 16bit sample size on reading</span>
        wave<span style="color:#000000">.</span>data <span style="color:#000000">=</span> <span style="color:#010181">drflac_open_memory_and_read_pcm_frames_s16</span><span style="color:#000000">(</span>fileData<span style="color:#000000">,</span> dataSize<span style="color:#000000">, &amp;</span>wave<span style="color:#000000">.</span>channels<span style="color:#000000">, &amp;</span>wave<span style="color:#000000">.</span>sampleRate<span style="color:#000000">, &amp;</span>totalFrameCount<span style="color:#000000">,</span> NULL<span style="color:#000000">);</span>
        wave<span style="color:#000000">.</span>sampleSize <span style="color:#000000">=</span> <span style="color:#b07e00">16</span><span style="color:#000000">;</span>
        <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>wave<span style="color:#000000">.</span>data <span style="color:#000000">!=</span> NULL<span style="color:#000000">)</span> wave<span style="color:#000000">.</span>frameCount <span style="color:#000000">= (</span><span style="color:#0057ae">unsigned int</span><span style="color:#000000">)</span>totalFrameCount<span style="color:#000000">;</span>
        <span style="color:#000000; font-weight:bold">else</span> <span style="color:#010181">TRACELOG</span><span style="color:#000000">(</span>LOG_WARNING<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;WAVE: Failed to load FLAC data&quot;</span><span style="color:#000000">);</span>
    <span style="color:#000000">}</span>
<span style="color:#008200">#endif</span>
    <span style="color:#000000; font-weight:bold">else</span> <span style="color:#010181">TRACELOG</span><span style="color:#000000">(</span>LOG_WARNING<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;WAVE: Data format not supported&quot;</span><span style="color:#000000">);</span>
    <span style="color:#010181">TRACELOG</span><span style="color:#000000">(</span>LOG_INFO<span style="color:#000000">,</span> <span style="color:#bf0303">&quot;WAVE: Data loaded successfully (%i Hz, %i bit, %i channels)&quot;</span><span style="color:#000000">,</span> wave<span style="color:#000000">.</span>sampleRate<span style="color:#000000">,</span> wave<span style="color:#000000">.</span>sampleSize<span style="color:#000000">,</span> wave<span style="color:#000000">.</span>channels<span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">return</span> wave<span style="color:#000000">;</span>
<span style="color:#000000">}</span>
