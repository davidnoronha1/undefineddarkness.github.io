FilePathList <span style="color:#010181">LoadDirectoryFilesEx</span><span style="color:#000000">(</span><span style="color:#0057ae">const char</span> <span style="color:#000000">*</span>basePath<span style="color:#000000">,</span> <span style="color:#0057ae">const char</span> <span style="color:#000000">*</span>filter<span style="color:#000000">,</span> <span style="color:#0057ae">bool</span> scanSubdirs<span style="color:#000000">){</span>
    FilePathList files <span style="color:#000000">= {</span> <span style="color:#b07e00">0</span> <span style="color:#000000">};</span>
    files<span style="color:#000000">.</span>capacity <span style="color:#000000">=</span> MAX_FILEPATH_CAPACITY<span style="color:#000000">;</span>
    files<span style="color:#000000">.</span>paths <span style="color:#000000">= (</span><span style="color:#0057ae">char</span> <span style="color:#000000">**)</span><span style="color:#010181">RL_CALLOC</span><span style="color:#000000">(</span>files<span style="color:#000000">.</span>capacity<span style="color:#000000">,</span> <span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">char</span> <span style="color:#000000">*));</span>
    <span style="color:#000000; font-weight:bold">for</span> <span style="color:#000000">(</span><span style="color:#0057ae">unsigned int</span> i <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span> i <span style="color:#000000">&lt;</span> files<span style="color:#000000">.</span>capacity<span style="color:#000000">;</span> i<span style="color:#000000">++)</span> files<span style="color:#000000">.</span>paths<span style="color:#000000">[</span>i<span style="color:#000000">] = (</span><span style="color:#0057ae">char</span> <span style="color:#000000">*)</span><span style="color:#010181">RL_CALLOC</span><span style="color:#000000">(</span>MAX_FILEPATH_LENGTH<span style="color:#000000">,</span> <span style="color:#000000; font-weight:bold">sizeof</span><span style="color:#000000">(</span><span style="color:#0057ae">char</span><span style="color:#000000">));</span>
    <span style="color:#838183; font-style:italic">// WARNING: basePath is always prepended to scanned paths</span>
    <span style="color:#000000; font-weight:bold">if</span> <span style="color:#000000">(</span>scanSubdirs<span style="color:#000000">)</span> <span style="color:#010181">ScanDirectoryFilesRecursively</span><span style="color:#000000">(</span>basePath<span style="color:#000000">, &amp;</span>files<span style="color:#000000">,</span> filter<span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">else</span> <span style="color:#010181">ScanDirectoryFiles</span><span style="color:#000000">(</span>basePath<span style="color:#000000">, &amp;</span>files<span style="color:#000000">,</span> filter<span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">return</span> files<span style="color:#000000">;</span>
<span style="color:#000000">}</span>
